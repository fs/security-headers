require "rails_helper"

module Headlines
  describe GenerateVulnerabilityReport do
    describe ".call" do
      let!(:scan) { create :scan }

      subject(:vulnerabilities_report) { described_class.call.report }

      it "generates vulnerabilities report for all domains" do
        Headlines::SECURITY_HEADERS.each do |vulnerability|
          expect(vulnerabilities_report["#{vulnerability.gsub('-', '_')}"]).to be_present
        end
      end
    end
  end
end
